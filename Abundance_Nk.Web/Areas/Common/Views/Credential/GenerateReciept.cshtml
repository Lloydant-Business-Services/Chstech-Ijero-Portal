@model Abundance_Nk.Web.Areas.Common.Models.CommonViewModel



@*New*@
@{
    ViewBag.Title = "Payment Confirmation/Reciept Generation";
    Layout = "~/Views/Shared/_NewThemeLayout.cshtml";
}
<script src="~/Content/theme/login/assets/js/core/jquery.3.2.1.min.js"></script>

<script type="text/javascript">
    var rrrNumberPayload;
    var ivn;
    var amount;
    $(document).ready(function () {
        $('#generateReciept').on('click', function () {
            //$('#approveBtn').off('click');

            rrrNumber = $('#rrrNum').val();
            if (rrrNumber == null || rrrNumber == '') {
                alert("RRR Number field cannot be left empty")
                return;
            }

            console.log(rrrNumber, "Info")
            $("#spinnerModal").show();
            rrrNumberPayload = rrrNumber
            processRequest();

        })

            function processRequest() {
                    $.ajax({
                type: 'POST',
                url: '@Url.Action("RecieptGeneration", "Credential")',
                dataType: 'json',
                data: { rrrNum: rrrNumberPayload, },
                success: function (result) {
                    if (!result.IsError) {
                        alert(result.Message);
                        @*var url2 = '@Url.Action("RecieptGeneration", "Credential")';
                        window.location.href = url2;*@

                    }
                    else {
                        alert(result.Message);
                        @*var url = '@Url.Action("RecieptGeneration", "Credential")';
                        window.location.href = url;*@
                    }
                },
                error: function (ex) {
                    alert('Failed to retrieve approval.' + result.Message);
                }
            });
    };
    });
</script>
<br />
<div class="row">


    <div class="col-md-12">
        <div class="row">
            <div class="col-md-12">
                <h3>@ViewBag.Title</h3>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <section id="loginForm">


                    @Html.AntiForgeryToken()
                    <div class="form-group">
                        <h6>Please enter your <b>RRR Number</b> below to verify payment for reciept generation accordingly.</h6>
                        <hr class="no-top-padding" />
                    </div>
@using (Html.BeginForm("GenerateReciept", "Credential", FormMethod.Post))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)

                    <div class="form-group">
                        @Html.LabelFor(m => m.RRRNumber, new { @class = "col-md-12 control-label" })
                        <div class="col-md-12">
                            @*@Html.TextBoxFor(m => m.RRRNumber, new { @class = "form-control", required = "required", @id = "rrrNum", @name = "remitaCode" })
                            @Html.ValidationMessageFor(m => m.RRRNumber, null, new { @class = "text-danger" })*@
                            <input class = "form-control" required="required" name="remitaCode"/>
                        </div>
                    </div>
                    @*<div class="form-group">
                            @Html.LabelFor(m => m.ScratchCard.Pin, new { @class = "col-md-3 control-label" })
                            <div class="col-md-9">
                                @Html.PasswordFor(m => m.ScratchCard.Pin, new { @class = "form-control", required = "required" })
                                @Html.ValidationMessageFor(m => m.ScratchCard.Pin, null, new { @class = "text-danger" })
                            </div>
                        </div>*@

                    <div class="form-group">
                        <div class=" col-md-12">
                          
                            <input type="submit" value="Generate" class="btn btn-default" />

                        </div>
                    </div>
}
                    <div class="row">
                        <div class="col-md-12">
                            @if (TempData["Message"] != null)
                            {
                                @Html.Partial("_Message", (Abundance_Nk.Model.Model.Message)TempData["Message"])
                            }
                        </div>
                    </div>

                </section>
            </div>
        </div>
    </div>
</div>



@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
